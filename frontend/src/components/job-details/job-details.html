<dom-module id="job-details">
  <template>
    <link rel="stylesheet" href="./job-details.css">

    <div class="flex">
      <div class="pipeline-name">[[pipeline.name]]</div>
      <div class="right">
        <div class="flex">
          <iron-icon class="state-icon" icon=[[_getStateIcon(job.state)]]></iron-icon>
          <!-- TODO: Get or compute the job progress here -->
          <paper-progress id="progress" value="100"></paper-progress>
        </div>
        <div>
          <span class="state">[[_getState(job.state)]]</span>
        </div>
      </div>
    </div>

    <hr>

    <div class="flex">
      <div class="left-column">
        <div>
          <span class="strong">Pipeline Package: </span>[[pipeline.packageId]]
        </div>

        <div>
          <span class="strong">Description: </span>[[pipeline.description]]
        </div>

        <div>
          <span class="strong">Start: </span>[[job.start]]
        </div>

        <div>
          <span class="strong">End: </span>[[job.end]]
        </div>

        <div>
          <span class="strong">Run time: </span>[[_getRuntime(job.start, job.end, job.state)]]
        </div>
      </div>

      <div>
        <div>
          <span class="strong">Parameters</span>
          <tr>
            <template is="dom-repeat" items="[[pipeline.parameterValues]]" as="param">
              <li>
                <span class="strong">[[param.name]]:</span>[[param.value]]
              </li>
            </template>
          </tr>
        </div>
      </div>
    </div>

    <hr>

    <div class="steps" hidden$="[[!job.steps]]">
      <div class="strong">Pipeline Steps:</div>
      <paper-tabs id="stepTabs" class="no-shrink" on-selected-changed="_stepSelected">
        <template is="dom-repeat" items="[[job.steps]]" as="step">
          <paper-tab>[[step.name]]</paper-tab>
        </template>
      </paper-tabs>
      <file-browser id="fileBrowser"></file-browser>

      <div class="flex action-buttons">
        <paper-button class="action-button" on-click="_preview">Preview</paper-button>
        <paper-button class="action-button" on-click="_plot">Plot</paper-button>
      </div>

      <div class="dialogs">
        <paper-dialog with-backdrop id="previewDialog">
          <div id="previewTitle"></div>
          <div id="preview"></div>
          <div class="dialog-buttons">
            <paper-button dialog-confirm autofocus>Close</paper-button>
          </div>
        </paper-dialog>

        <paper-dialog with-backdrop id="plotDialog">
          <div id="plotTitle"></div>
          <div id="plot"></div>
          <div class="dialog-buttons">
            <paper-button dialog-confirm autofocus>Close</paper-button>
          </div>
        </paper-dialog>
      </div>
    </div>

  </template>
</dom-module>
