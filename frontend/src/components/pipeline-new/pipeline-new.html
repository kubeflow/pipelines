<dom-module id="pipeline-new">
  <template>
    <link rel="stylesheet" href="./pipeline-new.css">

    <style>
      /*
      This is here instead of in the .css file because of css-loader, which
      tries to validate CSS while loading, and ends up commenting out all
      mixins, since they're not officially in the CSS spec.
      */
      paper-dropdown-menu,
      paper-input {
        --paper-input-container: {
          padding: 0;
        }
        --paper-input-container-label: {
          padding-left: 6px;
        }
        --paper-input-container-input: {
          padding-left: 6px;
        }
        --paper-input-container-label-floating: {
          padding-left: 8px;
        }
      }
    </style>

    <div class="toolbar">
      <div class="toolbar-title">
        Configure new pipeline pipeline:
      </div>
    </div>

    <div class="padded-20">
      <div class="flex">
        <paper-dropdown-menu label="Choose a Package" noink on-selected-item-changed="_packageChanged">
          <paper-listbox id="packagesListbox" slot="dropdown-content" class="dropdown-content">
            <template is="dom-repeat" items="[[packages]]" as="package">
              <paper-item package-id="[[package.id]]">
                [[package.name]]
                <span class="padded faded">[[[package.id]]]</span>
              </paper-item>
            </template>
          </paper-listbox>
        </paper-dropdown-menu>
        <span class="padded">- Or -</span>
        <paper-button class="action-button" on-click="_altUpload">
          Upload New Package
        </paper-button>
        <!--This is hidden but its functionality is used by the alt upload button above-->
        <input type="file" id="altFileUpload" style="display: none" on-change="_upload">
      </div>

      <paper-input id="name" label="Pipeline Name" autofocus></paper-input>
      <paper-input id="description" label="Description"></paper-input>

      <template is="dom-if" if="[[parameters.length]]">
        <br>
        <br>
        <span class="strong">Parameters</span>
        <template is="dom-repeat" items="{{parameters}}" as="param">
          <div class="flex param-container">
            <paper-input class="param-input no-shrink" value="{{param.value}}" label="[[param.name]]"></paper-input>
            <span>[[param.description]]</span>
          </div>
        </template>
      </template>

      <hr>

      <paper-button class="action-button" raised on-click="_deploy">
        Deploy
        <iron-icon icon="chevron-right"></iron-icon>
      </paper-button>
    </div>

    <div class="overlay" hidden="[[!_busy]]">
      <paper-spinner active></paper-spinner>
    </div>

  </template>
</dom-module>
