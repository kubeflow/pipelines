<dom-module id="pipeline-new">
  <template>
    <link rel="stylesheet" href="./pipeline-new.css">

    <div class="strong padded">Configure new pipeline pipeline:</div>

    <div class="flex">
      <paper-dropdown-menu-light label="Choose a Package" noink no-label-float
                                 on-selected-item-changed="_packageChanged">
        <paper-listbox id="packagesListbox" slot="dropdown-content" class="dropdown-content">
          <template is="dom-repeat" items="[[packages]]" as="package">
            <paper-item package-id="[[package.id]]">
              [[package.name]]
              <span class="padded faded">[[[package.id]]]</span>
            </paper-item>
          </template>
        </paper-listbox>
      </paper-dropdown-menu-light>
      <span class="padded">- Or -</span>
      <paper-button class="action-button" on-click="_altUpload">
        Upload New Package
      </paper-button>
      <!--This is hidden but its functionality is used by the alt upload button above-->
      <input type="file" id="altFileUpload" style="display: none" on-change="_upload">
    </div>

    <paper-input id="name" label="Pipeline Name" autofocus no-label-float></paper-input>
    <paper-input id="description" label="Description" no-label-float></paper-input>

    <br>
    <br>
    <span class="strong">Schedule</span>
    <div class="flex">
      <paper-input id="starts" label="Starts" value="[[startDate]]"></paper-input>
      <paper-icon-button icon="date-range" on-click="_pickStartDate" tabindex="-1">
      </paper-icon-button>
    </div>
    <div class="flex">
      <paper-input id="ends" label="Ends" value="[[endDate]]"></paper-input>
      <paper-icon-button icon="date-range" on-click="_pickEndDate" tabindex="-1">
      </paper-icon-button>
    </div>

    <template is="dom-if" if="[[parameters.length]]">
      <br>
      <br>
      <span class="strong">Parameters</span>
      <template is="dom-repeat" items="{{parameters}}" as="param">
        <div class="flex param-container">
          <span class="strong param-name">[[param.name]]: </span>
          <paper-input class="param-input" value="{{param.value}}" no-label-float></paper-input>
          <span class="param-description">[[param.description]]</span>
        </div>
      </template>
    </template>

    <app-datepicker-dialog modal id="startDatepicker" date="{{startDate}}"></app-datepicker-dialog>
    <app-datepicker-dialog modal id="endDatepicker" date="{{endDate}}"></app-datepicker-dialog>

    <hr>

    <paper-button class="action-button" raised on-click="_deploy">
      Deploy
      <iron-icon icon="chevron-right"></iron-icon>
    </paper-button>

    <div class="overlay" hidden="[[!_busy]]">
      <paper-spinner active></paper-spinner>
    </div>

  </template>
</dom-module>
