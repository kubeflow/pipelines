# PIPELINE DEFINITION
# Name: nb-simple
components:
  comp-read-embedded-artifact-dir:
    executorLabel: exec-read-embedded-artifact-dir
  comp-read-embedded-artifact-file:
    executorLabel: exec-read-embedded-artifact-file
deploymentSpec:
  executors:
    exec-read-embedded-artifact-dir:
      container:
        args:
        - --executor_input
        - '{{$}}'
        - --function_to_execute
        - read_embedded_artifact_dir
        command:
        - sh
        - -c
        - "\nif ! [ -x \"$(command -v pip)\" ]; then\n    python3 -m ensurepip ||\
          \ python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1\
          \ python3 -m pip install --quiet --no-warn-script-location 'kfp==2.14.2'\
          \ '--no-deps' 'typing-extensions>=3.7.4,<5; python_version<\"3.9\"' && \"\
          $0\" \"$@\"\n"
        - sh
        - -ec
        - 'program_path=$(mktemp -d)


          printf "%s" "$0" > "$program_path/ephemeral_component.py"

          _KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         "$program_path/ephemeral_component.py"                         "$@"

          '
        - "\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import\
          \ *\n\n__KFP_EMBEDDED_ARCHIVE_B64 = 'H4sIAHnS2mgC/+3UvQ6CMBSG4c5eBe6mnNPSFgYTR0ZvgUSiJiWYipHLF+KgRokTxJ/vWdoASYdyXhnLeLUu2rwsNmUQo6CroZVIJ7d9/5xJsRJRKyZwOjZF6I4X/0mlUdXsq3LJzmTsmDMtKctS7fRMwM+T8fhn9EPtjBGkSRu+W+9mng1Zawx3v2A//1Z182+mnP/qEIqdH/7u3fuvvf9P6L9+7j+j/5P0373uv0X+/6T/vt7Kpm1G7r9NkuH+d/vH/itOSESE/o8uL72vF9G5Dn4zxzgAAAAAAAAAAAAAAAAAfLULZBWkcAAoAAA='\n\
          \nimport base64 as __kfp_b64\nimport io as __kfp_io\nimport os as __kfp_os\n\
          import sys as __kfp_sys\nimport tarfile as __kfp_tarfile\nimport tempfile\
          \ as __kfp_tempfile\n\n# Extract embedded archive at import time to ensure\
          \ sys.path and globals are set\n__kfp_tmpdir = __kfp_tempfile.TemporaryDirectory()\n\
          __KFP_EMBEDDED_ASSET_DIR = __kfp_tmpdir.name\ntry:\n    __kfp_bytes = __kfp_b64.b64decode(__KFP_EMBEDDED_ARCHIVE_B64.encode('ascii'))\n\
          \    with __kfp_tarfile.open(fileobj=__kfp_io.BytesIO(__kfp_bytes), mode='r:gz')\
          \ as __kfp_tar:\n        __kfp_tar.extractall(path=__KFP_EMBEDDED_ASSET_DIR)\n\
          except Exception as __kfp_e:\n    raise RuntimeError(f'Failed to extract\
          \ embedded archive: {__kfp_e}')\n\n# Always prepend the extracted directory\
          \ to sys.path for import resolution\nif __KFP_EMBEDDED_ASSET_DIR not in\
          \ __kfp_sys.path:\n    __kfp_sys.path.insert(0, __KFP_EMBEDDED_ASSET_DIR)\n\
          \n\n\n\ndef read_embedded_artifact_dir(artifact: dsl.EmbeddedInput[dsl.Dataset]):\n\
          \    import os\n\n    with open(os.path.join(artifact.path, \"log.txt\"\
          ), \"r\", encoding=\"utf-8\") as f:\n        log = f.read()\n\n    assert\
          \ log == \"Hello, world!\"\n\n"
        image: python:3.9
    exec-read-embedded-artifact-file:
      container:
        args:
        - --executor_input
        - '{{$}}'
        - --function_to_execute
        - read_embedded_artifact_file
        command:
        - sh
        - -c
        - "\nif ! [ -x \"$(command -v pip)\" ]; then\n    python3 -m ensurepip ||\
          \ python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1\
          \ python3 -m pip install --quiet --no-warn-script-location 'kfp==2.14.2'\
          \ '--no-deps' 'typing-extensions>=3.7.4,<5; python_version<\"3.9\"' && \"\
          $0\" \"$@\"\n"
        - sh
        - -ec
        - 'program_path=$(mktemp -d)


          printf "%s" "$0" > "$program_path/ephemeral_component.py"

          _KFP_RUNTIME=true python3 -m kfp.dsl.executor_main                         --component_module_path                         "$program_path/ephemeral_component.py"                         "$@"

          '
        - "\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import\
          \ *\n\n__KFP_EMBEDDED_ARCHIVE_B64 = 'H4sIAHnS2mgC/+3UsQrCMBDG8cw+Rd2lvWua1g6Co6OvULCokFKpFfv4pog4iZNC9f9b7kgCt9yXOImT9bYaNnW1qzvzEXL3qopY++zHc5VU1USD+YLLua+6MN78p7SImv7Y1CstXKmFamljKctlbmcGv8+3+7gf+o/OGEOdZ5kRK9ape9aH0KuTPHdOwwqG/KfhTzCRfDP/zamrDv71u3f3E7WpvW8X0bXt/G5OHAAAAAAAAAAAAAAAACbnBq/wxAEAKAAA'\n\
          \nimport base64 as __kfp_b64\nimport io as __kfp_io\nimport os as __kfp_os\n\
          import sys as __kfp_sys\nimport tarfile as __kfp_tarfile\nimport tempfile\
          \ as __kfp_tempfile\n\n# Extract embedded archive at import time to ensure\
          \ sys.path and globals are set\n__kfp_tmpdir = __kfp_tempfile.TemporaryDirectory()\n\
          __KFP_EMBEDDED_ASSET_DIR = __kfp_tmpdir.name\ntry:\n    __kfp_bytes = __kfp_b64.b64decode(__KFP_EMBEDDED_ARCHIVE_B64.encode('ascii'))\n\
          \    with __kfp_tarfile.open(fileobj=__kfp_io.BytesIO(__kfp_bytes), mode='r:gz')\
          \ as __kfp_tar:\n        __kfp_tar.extractall(path=__KFP_EMBEDDED_ASSET_DIR)\n\
          except Exception as __kfp_e:\n    raise RuntimeError(f'Failed to extract\
          \ embedded archive: {__kfp_e}')\n\n# Always prepend the extracted directory\
          \ to sys.path for import resolution\nif __KFP_EMBEDDED_ASSET_DIR not in\
          \ __kfp_sys.path:\n    __kfp_sys.path.insert(0, __KFP_EMBEDDED_ASSET_DIR)\n\
          \n__KFP_EMBEDDED_ASSET_FILE = __kfp_os.path.join(__KFP_EMBEDDED_ASSET_DIR,\
          \ 'log.txt')\n\n\n\n\ndef read_embedded_artifact_file(artifact: dsl.EmbeddedInput[dsl.Dataset]):\n\
          \    with open(artifact.path, \"r\", encoding=\"utf-8\") as f:\n       \
          \ log = f.read()\n\n    assert log == \"Hello, world!\"\n\n"
        image: python:3.9
pipelineInfo:
  name: nb-simple
root:
  dag:
    tasks:
      read-embedded-artifact-dir:
        cachingOptions: {}
        componentRef:
          name: comp-read-embedded-artifact-dir
        taskInfo:
          name: read-embedded-artifact-dir
      read-embedded-artifact-file:
        cachingOptions: {}
        componentRef:
          name: comp-read-embedded-artifact-file
        taskInfo:
          name: read-embedded-artifact-file
schemaVersion: 2.1.0
sdkVersion: kfp-2.14.2
