{
    "pipelineSpec":{
       "components":{
          "comp-endpoint-create":{
             "executorLabel":"exec-endpoint-create",
             "inputDefinitions":{
                "parameters":{
                   "display_name":{
                      "type":"STRING"
                   },
                   "labels":{
                      "type":"STRING"
                   },
                   "location":{
                      "type":"STRING"
                   },
                   "project":{
                      "type":"STRING"
                   }
                }
             },
             "outputDefinitions":{
                "artifacts":{
                   "endpoint":{
                      "artifactType":{
                         "schemaTitle":"google.VertexEndpoint",
                         "schemaVersion":"0.0.1"
                      }
                   }
                },
                "parameters":{
                   "gcp_resources":{
                      "type":"STRING"
                   }
                }
             }
          },
          "comp-model-deploy":{
             "executorLabel":"exec-model-deploy",
             "inputDefinitions":{
                "artifacts":{
                   "endpoint":{
                      "artifactType":{
                         "schemaTitle":"google.VertexEndpoint",
                         "schemaVersion":"0.0.1"
                      }
                   },
                   "model":{
                      "artifactType":{
                         "schemaTitle":"google.VertexModel",
                         "schemaVersion":"0.0.1"
                      }
                   }
                },
                "parameters":{
                   "automatic_resources_max_replica_count":{
                      "type":"INT"
                   },
                   "automatic_resources_min_replica_count":{
                      "type":"INT"
                   },
                   "dedicated_resources_accelerator_count":{
                      "type":"INT"
                   },
                   "dedicated_resources_accelerator_type":{
                      "type":"STRING"
                   },
                   "dedicated_resources_machine_type":{
                      "type":"STRING"
                   },
                   "dedicated_resources_max_replica_count":{
                      "type":"INT"
                   },
                   "dedicated_resources_min_replica_count":{
                      "type":"INT"
                   },
                   "deployed_model_display_name":{
                      "type":"STRING"
                   },
                   "disable_container_logging":{
                      "type":"STRING"
                   },
                   "enable_access_logging":{
                      "type":"STRING"
                   },
                   "explanation_metadata":{
                      "type":"STRING"
                   },
                   "explanation_parameters":{
                      "type":"STRING"
                   },
                   "location":{
                      "type":"STRING"
                   },
                   "service_account":{
                      "type":"STRING"
                   },
                   "traffic_split":{
                      "type":"STRING"
                   }
                }
             },
             "outputDefinitions":{
                "parameters":{
                   "gcp_resources":{
                      "type":"STRING"
                   }
                }
             }
          },
          "comp-model-upload":{
             "executorLabel":"exec-model-upload",
             "inputDefinitions":{
                "parameters":{
                   "artifact_uri":{
                      "type":"STRING"
                   },
                   "display_name":{
                      "type":"STRING"
                   },
                   "explanation_metadata":{
                      "type":"STRING"
                   },
                   "explanation_parameters":{
                      "type":"STRING"
                   },
                   "labels":{
                      "type":"STRING"
                   },
                   "location":{
                      "type":"STRING"
                   },
                   "project":{
                      "type":"STRING"
                   },
                   "serving_container_args":{
                      "type":"STRING"
                   },
                   "serving_container_command":{
                      "type":"STRING"
                   },
                   "serving_container_environment_variables":{
                      "type":"STRING"
                   },
                   "serving_container_image_uri":{
                      "type":"STRING"
                   },
                   "serving_container_ports":{
                      "type":"STRING"
                   }
                }
             },
             "outputDefinitions":{
                "artifacts":{
                   "model":{
                      "artifactType":{
                         "schemaTitle":"google.VertexModel",
                         "schemaVersion":"0.0.1"
                      }
                   }
                },
                "parameters":{
                   "gcp_resources":{
                      "type":"STRING"
                   }
                }
             }
          }
       },
       "deploymentSpec":{
          "executors":{
             "exec-endpoint-create":{
                "container":{
                   "args":[
                      "--type",
                      "CreateEndpoint",
                      "--payload",
                      "{\"display_name\": \"{{$.inputs.parameters['display_name']}}\", \"description\": \"\", \"labels\": {{$.inputs.parameters['labels']}}, \"encryption_spec\": {\"kms_key_name\":\"\"}, \"network\": \"\"}",
                      "--project",
                      "{{$.inputs.parameters['project']}}",
                      "--location",
                      "{{$.inputs.parameters['location']}}",
                      "--gcp_resources",
                      "{{$.outputs.parameters['gcp_resources'].output_file}}",
                      "--executor_input",
                      "{{$}}"
                   ],
                   "command":[
                      "python3",
                      "-u",
                      "-m",
                      "google_cloud_pipeline_components.container.experimental.gcp_launcher.launcher"
                   ],
                   "image":"gcr.io/ml-pipeline/google-cloud-pipeline-components:latest"
                }
             },
             "exec-model-deploy":{
                "container":{
                   "args":[
                      "--type",
                      "DeployModel",
                      "--payload",
                      "{\"endpoint\": \"{{$.inputs.artifacts['endpoint'].metadata['resourceName']}}\", \"traffic_split\": {{$.inputs.parameters['traffic_split']}}, \"deployed_model\": {\"model\": \"{{$.inputs.artifacts['model'].metadata['resourceName']}}\", \"dedicated_resources\": {\"machine_spec\": {\"machine_type\": \"{{$.inputs.parameters['dedicated_resources_machine_type']}}\", \"accelerator_type\": \"{{$.inputs.parameters['dedicated_resources_accelerator_type']}}\", \"accelerator_count\": {{$.inputs.parameters['dedicated_resources_accelerator_count']}}}, \"min_replica_count\": {{$.inputs.parameters['dedicated_resources_min_replica_count']}}, \"max_replica_count\": {{$.inputs.parameters['dedicated_resources_max_replica_count']}}}, \"automatic_resources\": {\"min_replica_count\": {{$.inputs.parameters['automatic_resources_min_replica_count']}}, \"max_replica_count\": {{$.inputs.parameters['automatic_resources_max_replica_count']}}}, \"service_account\": \"{{$.inputs.parameters['service_account']}}\", \"disable_container_logging\": \"{{$.inputs.parameters['disable_container_logging']}}\", \"enable_access_logging\": \"{{$.inputs.parameters['enable_access_logging']}}\", \"explanation_spec\": {\"parameters\": {{$.inputs.parameters['explanation_parameters']}}, \"metadata\": {{$.inputs.parameters['explanation_metadata']}}}}}",
                      "--project",
                      "",
                      "--location",
                      "{{$.inputs.parameters['location']}}",
                      "--gcp_resources",
                      "{{$.outputs.parameters['gcp_resources'].output_file}}"
                   ],
                   "command":[
                      "python3",
                      "-u",
                      "-m",
                      "google_cloud_pipeline_components.container.experimental.gcp_launcher.launcher"
                   ],
                   "image":"gcr.io/ml-pipeline/google-cloud-pipeline-components:latest"
                }
             },
             "exec-model-upload":{
                "container":{
                   "args":[
                      "--type",
                      "UploadModel",
                      "--payload",
                      "{\"display_name\": \"{{$.inputs.parameters['display_name']}}\", \"description\": \"\", \"predict_schemata\": {\"instance_schema_uri\": \"\", \"parameters_schema_uri\": \"\", \"prediction_schema_uri\": \"\"}, \"container_spec\": {\"image_uri\": \"{{$.inputs.parameters['serving_container_image_uri']}}\", \"command\": {{$.inputs.parameters['serving_container_command']}}, \"args\": {{$.inputs.parameters['serving_container_args']}}, \"env\": {{$.inputs.parameters['serving_container_environment_variables']}}, \"ports\": {{$.inputs.parameters['serving_container_ports']}}, \"predict_route\": \"\", \"health_route\": \"\"}, \"artifact_uri\": \"{{$.inputs.parameters['artifact_uri']}}\", \"explanation_spec\": {\"parameters\": {{$.inputs.parameters['explanation_parameters']}}, \"metadata\": {{$.inputs.parameters['explanation_metadata']}}}, \"encryption_spec\": {\"kms_key_name\":\"\"}, \"labels\": {{$.inputs.parameters['labels']}}}",
                      "--project",
                      "{{$.inputs.parameters['project']}}",
                      "--location",
                      "{{$.inputs.parameters['location']}}",
                      "--gcp_resources",
                      "{{$.outputs.parameters['gcp_resources'].output_file}}",
                      "--executor_input",
                      "{{$}}"
                   ],
                   "command":[
                      "python3",
                      "-u",
                      "-m",
                      "google_cloud_pipeline_components.container.experimental.gcp_launcher.launcher"
                   ],
                   "image":"gcr.io/ml-pipeline/google-cloud-pipeline-components:latest"
                }
             }
          }
       },
       "pipelineInfo":{
          "name":"training-test"
       },
       "root":{
          "dag":{
             "tasks":{
                "endpoint-create":{
                   "cachingOptions":{
                      "enableCache":true
                   },
                   "componentRef":{
                      "name":"comp-endpoint-create"
                   },
                   "inputs":{
                      "parameters":{
                         "display_name":{
                            "runtimeValue":{
                               "constantValue":{
                                  "stringValue":"test_display_name"
                               }
                            }
                         },
                         "labels":{
                            "runtimeValue":{
                               "constantValue":{
                                  "stringValue":"{}"
                               }
                            }
                         },
                         "location":{
                            "runtimeValue":{
                               "constantValue":{
                                  "stringValue":"us-central1"
                               }
                            }
                         },
                         "project":{
                            "runtimeValue":{
                               "constantValue":{
                                  "stringValue":"test_project"
                               }
                            }
                         }
                      }
                   },
                   "taskInfo":{
                      "name":"endpoint-create"
                   }
                },
                "model-deploy":{
                   "cachingOptions":{
                      "enableCache":true
                   },
                   "componentRef":{
                      "name":"comp-model-deploy"
                   },
                   "dependentTasks":[
                      "endpoint-create",
                      "model-upload"
                   ],
                   "inputs":{
                      "artifacts":{
                         "endpoint":{
                            "taskOutputArtifact":{
                               "outputArtifactKey":"endpoint",
                               "producerTask":"endpoint-create"
                            }
                         },
                         "model":{
                            "taskOutputArtifact":{
                               "outputArtifactKey":"model",
                               "producerTask":"model-upload"
                            }
                         }
                      },
                      "parameters":{
                         "automatic_resources_max_replica_count":{
                            "runtimeValue":{
                               "constantValue":{
                                  "intValue":"2"
                               }
                            }
                         },
                         "automatic_resources_min_replica_count":{
                            "runtimeValue":{
                               "constantValue":{
                                  "intValue":"1"
                               }
                            }
                         },
                         "dedicated_resources_accelerator_count":{
                            "runtimeValue":{
                               "constantValue":{
                                  "intValue":"1"
                               }
                            }
                         },
                         "dedicated_resources_accelerator_type":{
                            "runtimeValue":{
                               "constantValue":{
                                  "stringValue":"fake-accelerator"
                               }
                            }
                         },
                         "dedicated_resources_machine_type":{
                            "runtimeValue":{
                               "constantValue":{
                                  "stringValue":"n1-standard-4"
                               }
                            }
                         },
                         "dedicated_resources_max_replica_count":{
                            "runtimeValue":{
                               "constantValue":{
                                  "intValue":"2"
                               }
                            }
                         },
                         "dedicated_resources_min_replica_count":{
                            "runtimeValue":{
                               "constantValue":{
                                  "intValue":"1"
                               }
                            }
                         },
                         "deployed_model_display_name":{
                            "runtimeValue":{
                               "constantValue":{
                                  "stringValue":"deployed_model_display_name"
                               }
                            }
                         },
                         "disable_container_logging":{
                            "runtimeValue":{
                               "constantValue":{
                                  "intValue":"1"
                               }
                            }
                         },
                         "enable_access_logging":{
                            "runtimeValue":{
                               "constantValue":{
                                  "intValue":"1"
                               }
                            }
                         },
                         "explanation_metadata":{
                            "runtimeValue":{
                               "constantValue":{
                                  "stringValue":"{\"xai_m\":\"bar\"}"
                               }
                            }
                         },
                         "explanation_parameters":{
                            "runtimeValue":{
                               "constantValue":{
                                  "stringValue":"{\"xai_p\":\"foo\"}"
                               }
                            }
                         },
                         "location":{
                            "runtimeValue":{
                               "constantValue":{
                                  "stringValue":"us-central1"
                               }
                            }
                         },
                         "service_account":{
                            "runtimeValue":{
                               "constantValue":{
                                  "stringValue":"fake-sa"
                               }
                            }
                         },
                         "traffic_split":{
                            "runtimeValue":{
                               "constantValue":{
                                  "stringValue":"{}"
                               }
                            }
                         }
                      }
                   },
                   "taskInfo":{
                      "name":"model-deploy"
                   }
                },
                "model-upload":{
                   "cachingOptions":{
                      "enableCache":true
                   },
                   "componentRef":{
                      "name":"comp-model-upload"
                   },
                   "inputs":{
                      "parameters":{
                         "artifact_uri":{
                            "runtimeValue":{
                               "constantValue":{
                                  "stringValue":"project/test_artifact_uri"
                               }
                            }
                         },
                         "display_name":{
                            "runtimeValue":{
                               "constantValue":{
                                  "stringValue":"test_display_name"
                               }
                            }
                         },
                         "explanation_metadata":{
                            "runtimeValue":{
                               "constantValue":{
                                  "stringValue":"{}"
                               }
                            }
                         },
                         "explanation_parameters":{
                            "runtimeValue":{
                               "constantValue":{
                                  "stringValue":"{}"
                               }
                            }
                         },
                         "labels":{
                            "runtimeValue":{
                               "constantValue":{
                                  "stringValue":"{}"
                               }
                            }
                         },
                         "location":{
                            "runtimeValue":{
                               "constantValue":{
                                  "stringValue":"us-central1"
                               }
                            }
                         },
                         "project":{
                            "runtimeValue":{
                               "constantValue":{
                                  "stringValue":"test_project"
                               }
                            }
                         },
                         "serving_container_args":{
                            "runtimeValue":{
                               "constantValue":{
                                  "stringValue":"{}"
                               }
                            }
                         },
                         "serving_container_command":{
                            "runtimeValue":{
                               "constantValue":{
                                  "stringValue":"{}"
                               }
                            }
                         },
                         "serving_container_environment_variables":{
                            "runtimeValue":{
                               "constantValue":{
                                  "stringValue":"{}"
                               }
                            }
                         },
                         "serving_container_image_uri":{
                            "runtimeValue":{
                               "constantValue":{
                                  "stringValue":"gcr.io/test_project/test_image:test_tag"
                               }
                            }
                         },
                         "serving_container_ports":{
                            "runtimeValue":{
                               "constantValue":{
                                  "stringValue":"{}"
                               }
                            }
                         }
                      }
                   },
                   "taskInfo":{
                      "name":"model-upload"
                   }
                }
             }
          }
       }
    },
    "runtimeConfig":{
       
    }
 }