{
  "pipelineInfo":{
     "name":"pipeline"
  },
  "sdkVersion":"kfp-2.0.0-rc.1",
  "schemaVersion":"2.1.0",
  "deploymentSpec":{
     "executors":{
        "exec-sum-numbers":{
           "container":{
              "args":[
                 "--type",
                 "CustomJob",
                 "--payload",
                 "{\"display_name\": \"{{$.inputs.parameters['display_name']}}\", \"job_spec\": {\"worker_pool_specs\": {{$.inputs.parameters['worker_pool_specs']}}, \"scheduling\": {\"timeout\": \"{{$.inputs.parameters['timeout']}}\", \"restart_job_on_worker_restart\": {{$.inputs.parameters['restart_job_on_worker_restart']}}}, \"service_account\": \"{{$.inputs.parameters['service_account']}}\", \"tensorboard\": \"{{$.inputs.parameters['tensorboard']}}\", \"enable_web_access\": {{$.inputs.parameters['enable_web_access']}}, \"network\": \"{{$.inputs.parameters['network']}}\", \"reserved_ip_ranges\": {{$.inputs.parameters['reserved_ip_ranges']}}, \"base_output_directory\": {\"output_uri_prefix\": \"{{$.inputs.parameters['base_output_directory']}}\"}}, \"labels\": {{$.inputs.parameters['labels']}}, \"encryption_spec_key_name\": {\"kms_key_name\": \"{{$.inputs.parameters['encryption_spec_key_name']}}\"}}",
                 "--project",
                 "{{$.inputs.parameters['project']}}",
                 "--location",
                 "{{$.inputs.parameters['location']}}",
                 "--gcp_resources",
                 "{{$.outputs.parameters['gcp_resources'].output_file}}"
              ],
              "image":"gcr.io/ml-pipeline/google-cloud-pipeline-components:2.0.0b3",
              "command":[
                 "python3",
                 "-u",
                 "-m",
                 "google_cloud_pipeline_components.container.v1.custom_job.launcher"
              ]
           }
        }
     }
  },
  "components":{
     "comp-sum-numbers":{
        "inputDefinitions":{
           "parameters":{
              "service_account":{
                 "parameterType":"STRING",
                 "defaultValue":"",
                 "isOptional":true
              },
              "tensorboard":{
                 "parameterType":"STRING",
                 "defaultValue":"",
                 "isOptional":true
              },
              "a":{
                 "parameterType":"NUMBER_INTEGER"
              },
              "encryption_spec_key_name":{
                 "parameterType":"STRING",
                 "defaultValue":"",
                 "isOptional":true
              },
              "worker_pool_specs":{
                 "parameterType":"LIST",
                 "defaultValue":[
                    {
                       "replica_count":1.0,
                       "container_spec":{
                          "image_uri":"python:3.7",
                          "command":[
                             "sh",
                             "-c",
                             "\nif ! [ -x \"$(command -v pip)\" ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet     --no-warn-script-location 'kfp==2.0.0-beta.14' && \"$0\" \"$@\"\n",
                             "sh",
                             "-ec",
                             "program_path=$(mktemp -d)\nprintf \"%s\" \"$0\" > \"$program_path/ephemeral_component.py\"\npython3 -m kfp.components.executor_main                         --component_module_path                         \"$program_path/ephemeral_component.py\"                         \"$@\"\n",
                             "\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef sum_numbers(a: int, b: int) -> int:\n  return a + b\n\n"
                          ],
                          "args":[
                             "--executor_input",
                             "{{$.json_escape[1]}}",
                             "--function_to_execute",
                             "sum_numbers"
                          ]
                       },
                       "machine_spec":{
                          "machine_type":"n1-standard-4"
                       },
                       "disk_spec":{
                          "boot_disk_size_gb":100.0,
                          "boot_disk_type":"pd-ssd"
                       }
                    }
                 ],
                 "isOptional":true
              },
              "display_name":{
                 "parameterType":"STRING",
                 "defaultValue":"sum-numbers",
                 "isOptional":true
              },
              "timeout":{
                 "parameterType":"STRING",
                 "defaultValue":"604800s",
                 "isOptional":true
              },
              "location":{
                 "parameterType":"STRING",
                 "defaultValue":"us-central1",
                 "isOptional":true
              },
              "reserved_ip_ranges":{
                 "parameterType":"LIST",
                 "defaultValue":[

                 ],
                 "isOptional":true
              },
              "base_output_directory":{
                 "parameterType":"STRING",
                 "defaultValue":"",
                 "isOptional":true
              },
              "labels":{
                 "parameterType":"STRUCT",
                 "defaultValue":{

                 },
                 "isOptional":true
              },
              "network":{
                 "parameterType":"STRING",
                 "defaultValue":"",
                 "isOptional":true
              },
              "enable_web_access":{
                 "parameterType":"BOOLEAN",
                 "defaultValue":false,
                 "isOptional":true
              },
              "b":{
                 "parameterType":"NUMBER_INTEGER"
              },
              "project":{
                 "parameterType":"STRING"
              },
              "restart_job_on_worker_restart":{
                 "parameterType":"BOOLEAN",
                 "defaultValue":false,
                 "isOptional":true
              }
           }
        },
        "outputDefinitions":{
           "parameters":{
              "Output":{
                 "parameterType":"NUMBER_INTEGER"
              },
              "gcp_resources":{
                 "parameterType":"STRING"
              }
           }
        },
        "executorLabel":"exec-sum-numbers"
     }
  },
  "root":{
     "dag":{
        "tasks":{
           "sum-numbers":{
              "taskInfo":{
                 "name":"sum-numbers"
              },
              "inputs":{
                 "parameters":{
                    "a":{
                       "runtimeValue":{
                          "constant":1.0
                       }
                    },
                    "location":{
                       "runtimeValue":{
                          "constant":"us-central1"
                       }
                    },
                    "b":{
                       "runtimeValue":{
                          "constant":2.0
                       }
                    },
                    "project":{
                       "runtimeValue":{
                          "constant":"my-project"
                       }
                    }
                 }
              },
              "cachingOptions":{
                 "enableCache":true
              },
              "componentRef":{
                 "name":"comp-sum-numbers"
              }
           }
        }
     }
  }
}