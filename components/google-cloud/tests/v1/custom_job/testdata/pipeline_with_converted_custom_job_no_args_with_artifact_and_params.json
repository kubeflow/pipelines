{
   "pipelineInfo":{
      "name":"pipeline"
   },
   "sdkVersion":"kfp-2.0.0-rc.1",
   "schemaVersion":"2.1.0",
   "deploymentSpec":{
      "executors":{
         "exec-make-artifact":{
            "container":{
               "image":"python:3.7",
               "args":[
                  "--executor_input",
                  "{{$}}",
                  "--function_to_execute",
                  "make_artifact"
               ],
               "command":[
                  "sh",
                  "-c",
                  "\nif ! [ -x \"$(command -v pip)\" ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet     --no-warn-script-location 'kfp==2.0.0-beta.14' && \"$0\" \"$@\"\n",
                  "sh",
                  "-ec",
                  "program_path=$(mktemp -d)\nprintf \"%s\" \"$0\" > \"$program_path/ephemeral_component.py\"\npython3 -m kfp.components.executor_main                         --component_module_path                         \"$program_path/ephemeral_component.py\"                         \"$@\"\n",
                  "\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef make_artifact(\n    out_artifact: Output[Artifact],\n):\n  ...\n\n"
               ]
            }
         },
         "exec-dummy-component":{
            "container":{
               "image":"gcr.io/ml-pipeline/google-cloud-pipeline-components:2.0.0b3",
               "command":[
                  "python3",
                  "-u",
                  "-m",
                  "google_cloud_pipeline_components.container.v1.custom_job.launcher"
               ],
               "args":[
                  "--type",
                  "CustomJob",
                  "--payload",
                  "{\"display_name\": \"{{$.inputs.parameters['display_name']}}\", \"job_spec\": {\"worker_pool_specs\": {{$.inputs.parameters['worker_pool_specs']}}, \"scheduling\": {\"timeout\": \"{{$.inputs.parameters['timeout']}}\", \"restart_job_on_worker_restart\": {{$.inputs.parameters['restart_job_on_worker_restart']}}}, \"service_account\": \"{{$.inputs.parameters['service_account']}}\", \"tensorboard\": \"{{$.inputs.parameters['tensorboard']}}\", \"enable_web_access\": {{$.inputs.parameters['enable_web_access']}}, \"network\": \"{{$.inputs.parameters['network']}}\", \"reserved_ip_ranges\": {{$.inputs.parameters['reserved_ip_ranges']}}, \"base_output_directory\": {\"output_uri_prefix\": \"{{$.inputs.parameters['base_output_directory']}}\"}}, \"labels\": {{$.inputs.parameters['labels']}}, \"encryption_spec_key_name\": {\"kms_key_name\": \"{{$.inputs.parameters['encryption_spec_key_name']}}\"}}",
                  "--project",
                  "{{$.inputs.parameters['project']}}",
                  "--location",
                  "{{$.inputs.parameters['location']}}",
                  "--gcp_resources",
                  "{{$.outputs.parameters['gcp_resources'].output_file}}"
               ]
            }
         }
      }
   },
   "components":{
      "comp-dummy-component":{
         "inputDefinitions":{
            "artifacts":{
               "in_artifact":{
                  "artifactType":{
                     "schemaTitle":"system.Artifact",
                     "schemaVersion":"0.0.1"
                  }
               }
            },
            "parameters":{
               "enable_web_access":{
                  "parameterType":"BOOLEAN",
                  "defaultValue":false,
                  "isOptional":true
               },
               "in_param":{
                  "parameterType":"NUMBER_INTEGER"
               },
               "reserved_ip_ranges":{
                  "parameterType":"LIST",
                  "defaultValue":[

                  ],
                  "isOptional":true
               },
               "display_name":{
                  "parameterType":"STRING",
                  "defaultValue":"dummy-component",
                  "isOptional":true
               },
               "tensorboard":{
                  "parameterType":"STRING",
                  "defaultValue":"",
                  "isOptional":true
               },
               "worker_pool_specs":{
                  "parameterType":"LIST",
                  "defaultValue":[
                     {
                        "container_spec":{
                           "command":[
                              "sh",
                              "-c",
                              "\nif ! [ -x \"$(command -v pip)\" ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet     --no-warn-script-location 'kfp==2.0.0-beta.14' && \"$0\" \"$@\"\n",
                              "sh",
                              "-ec",
                              "program_path=$(mktemp -d)\nprintf \"%s\" \"$0\" > \"$program_path/ephemeral_component.py\"\npython3 -m kfp.components.executor_main                         --component_module_path                         \"$program_path/ephemeral_component.py\"                         \"$@\"\n",
                              "\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef dummy_component(\n    in_param: int,\n    in_artifact: Input[Artifact],\n    out_artifact: Output[Artifact],\n) -> str:\n  pass\n\n"
                           ],
                           "args":[
                              "--executor_input",
                              "{{$.json_escape[1]}}",
                              "--function_to_execute",
                              "dummy_component"
                           ],
                           "image_uri":"python:3.7"
                        },
                        "replica_count":1.0,
                        "disk_spec":{
                           "boot_disk_type":"pd-ssd",
                           "boot_disk_size_gb":100.0
                        },
                        "machine_spec":{
                           "machine_type":"n1-standard-4"
                        }
                     }
                  ],
                  "isOptional":true
               },
               "project":{
                  "parameterType":"STRING"
               },
               "encryption_spec_key_name":{
                  "parameterType":"STRING",
                  "defaultValue":"",
                  "isOptional":true
               },
               "timeout":{
                  "parameterType":"STRING",
                  "defaultValue":"604800s",
                  "isOptional":true
               },
               "restart_job_on_worker_restart":{
                  "parameterType":"BOOLEAN",
                  "defaultValue":false,
                  "isOptional":true
               },
               "location":{
                  "parameterType":"STRING",
                  "defaultValue":"us-central1",
                  "isOptional":true
               },
               "labels":{
                  "parameterType":"STRUCT",
                  "defaultValue":{

                  },
                  "isOptional":true
               },
               "base_output_directory":{
                  "parameterType":"STRING",
                  "defaultValue":"",
                  "isOptional":true
               },
               "network":{
                  "parameterType":"STRING",
                  "defaultValue":"",
                  "isOptional":true
               },
               "service_account":{
                  "parameterType":"STRING",
                  "defaultValue":"",
                  "isOptional":true
               }
            }
         },
         "outputDefinitions":{
            "artifacts":{
               "out_artifact":{
                  "artifactType":{
                     "schemaTitle":"system.Artifact",
                     "schemaVersion":"0.0.1"
                  }
               }
            },
            "parameters":{
               "Output":{
                  "parameterType":"STRING"
               },
               "gcp_resources":{
                  "parameterType":"STRING"
               }
            }
         },
         "executorLabel":"exec-dummy-component"
      },
      "comp-make-artifact":{
         "outputDefinitions":{
            "artifacts":{
               "out_artifact":{
                  "artifactType":{
                     "schemaTitle":"system.Artifact",
                     "schemaVersion":"0.0.1"
                  }
               }
            }
         },
         "executorLabel":"exec-make-artifact"
      }
   },
   "root":{
      "dag":{
         "tasks":{
            "dummy-component":{
               "taskInfo":{
                  "name":"dummy-component"
               },
               "inputs":{
                  "parameters":{
                     "in_param":{
                        "runtimeValue":{
                           "constant":1.0
                        }
                     },
                     "location":{
                        "runtimeValue":{
                           "constant":"us-central1"
                        }
                     },
                     "project":{
                        "runtimeValue":{
                           "constant":"my-project"
                        }
                     }
                  },
                  "artifacts":{
                     "in_artifact":{
                        "taskOutputArtifact":{
                           "producerTask":"make-artifact",
                           "outputArtifactKey":"out_artifact"
                        }
                     }
                  }
               },
               "dependentTasks":[
                  "make-artifact"
               ],
               "cachingOptions":{
                  "enableCache":true
               },
               "componentRef":{
                  "name":"comp-dummy-component"
               }
            },
            "make-artifact":{
               "taskInfo":{
                  "name":"make-artifact"
               },
               "cachingOptions":{
                  "enableCache":true
               },
               "componentRef":{
                  "name":"comp-make-artifact"
               }
            }
         }
      }
   }
}