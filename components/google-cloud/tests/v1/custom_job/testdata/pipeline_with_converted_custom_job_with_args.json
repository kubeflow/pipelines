{
   "pipelineInfo":{
      "name":"pipeline"
   },
   "sdkVersion":"kfp-2.0.0-rc.1",
   "schemaVersion":"2.1.0",
   "deploymentSpec":{
      "executors":{
         "exec-sum-numbers":{
            "container":{
               "command":[
                  "python3",
                  "-u",
                  "-m",
                  "google_cloud_pipeline_components.container.v1.custom_job.launcher"
               ],
               "image":"gcr.io/ml-pipeline/google-cloud-pipeline-components:2.0.0b3",
               "args":[
                  "--type",
                  "CustomJob",
                  "--payload",
                  "{\"display_name\": \"{{$.inputs.parameters['display_name']}}\", \"job_spec\": {\"worker_pool_specs\": {{$.inputs.parameters['worker_pool_specs']}}, \"scheduling\": {\"timeout\": \"{{$.inputs.parameters['timeout']}}\", \"restart_job_on_worker_restart\": {{$.inputs.parameters['restart_job_on_worker_restart']}}}, \"service_account\": \"{{$.inputs.parameters['service_account']}}\", \"tensorboard\": \"{{$.inputs.parameters['tensorboard']}}\", \"enable_web_access\": {{$.inputs.parameters['enable_web_access']}}, \"network\": \"{{$.inputs.parameters['network']}}\", \"reserved_ip_ranges\": {{$.inputs.parameters['reserved_ip_ranges']}}, \"base_output_directory\": {\"output_uri_prefix\": \"{{$.inputs.parameters['base_output_directory']}}\"}}, \"labels\": {{$.inputs.parameters['labels']}}, \"encryption_spec_key_name\": {\"kms_key_name\": \"{{$.inputs.parameters['encryption_spec_key_name']}}\"}}",
                  "--project",
                  "{{$.inputs.parameters['project']}}",
                  "--location",
                  "{{$.inputs.parameters['location']}}",
                  "--gcp_resources",
                  "{{$.outputs.parameters['gcp_resources'].output_file}}"
               ]
            }
         }
      }
   },
   "components":{
      "comp-sum-numbers":{
         "inputDefinitions":{
            "parameters":{
               "enable_web_access":{
                  "parameterType":"BOOLEAN",
                  "defaultValue":true,
                  "isOptional":true
               },
               "b":{
                  "parameterType":"NUMBER_INTEGER"
               },
               "base_output_directory":{
                  "parameterType":"STRING",
                  "defaultValue":"gs://my-vertex-pipelines-bucket/custom_job_outputs/",
                  "isOptional":true
               },
               "labels":{
                  "parameterType":"STRUCT",
                  "defaultValue":{
                     "k":"v"
                  },
                  "isOptional":true
               },
               "a":{
                  "parameterType":"NUMBER_INTEGER"
               },
               "tensorboard":{
                  "parameterType":"STRING",
                  "defaultValue":"projects/000000000000/locations/us-central1/tensorboards/000000000000",
                  "isOptional":true
               },
               "reserved_ip_ranges":{
                  "parameterType":"LIST",
                  "defaultValue":[
                     "1.0.0.0"
                  ],
                  "isOptional":true
               },
               "restart_job_on_worker_restart":{
                  "parameterType":"BOOLEAN",
                  "defaultValue":true,
                  "isOptional":true
               },
               "location":{
                  "parameterType":"STRING",
                  "defaultValue":"us-central1",
                  "isOptional":true
               },
               "encryption_spec_key_name":{
                  "parameterType":"STRING",
                  "defaultValue":"",
                  "isOptional":true
               },
               "network":{
                  "parameterType":"STRING",
                  "defaultValue":"",
                  "isOptional":true
               },
               "display_name":{
                  "parameterType":"STRING",
                  "defaultValue":"job_display_name",
                  "isOptional":true
               },
               "service_account":{
                  "parameterType":"STRING",
                  "defaultValue":"my-vertex-service-account@my-project.iam.gserviceaccount.com",
                  "isOptional":true
               },
               "project":{
                  "parameterType":"STRING"
               },
               "timeout":{
                  "parameterType":"STRING",
                  "defaultValue":"1000s",
                  "isOptional":true
               },
               "worker_pool_specs":{
                  "parameterType":"LIST",
                  "defaultValue":[
                     {
                        "container_spec":{
                           "args":[
                              "--executor_input",
                              "{{$.json_escape[1]}}",
                              "--function_to_execute",
                              "sum_numbers"
                           ],
                           "command":[
                              "sh",
                              "-c",
                              "\nif ! [ -x \"$(command -v pip)\" ]; then\n    python3 -m ensurepip || python3 -m ensurepip --user || apt-get install python3-pip\nfi\n\nPIP_DISABLE_PIP_VERSION_CHECK=1 python3 -m pip install --quiet     --no-warn-script-location 'kfp==2.0.0-rc.1' && \"$0\" \"$@\"\n",
                              "sh",
                              "-ec",
                              "program_path=$(mktemp -d)\nprintf \"%s\" \"$0\" > \"$program_path/ephemeral_component.py\"\npython3 -m kfp.components.executor_main                         --component_module_path                         \"$program_path/ephemeral_component.py\"                         \"$@\"\n",
                              "\nimport kfp\nfrom kfp import dsl\nfrom kfp.dsl import *\nfrom typing import *\n\ndef sum_numbers(a: int, b: int) -> int:\n  return a + b\n\n"
                           ],
                           "image_uri":"python:3.7"
                        },
                        "disk_spec":{
                           "boot_disk_size_gb":100.0,
                           "boot_disk_type":"pd-ssd"
                        },
                        "replica_count":1.0,
                        "machine_spec":{
                           "accelerator_type":"NVIDIA_TESLA_A100",
                           "accelerator_count":10.0,
                           "machine_type":"a2-ultragpu-1g"
                        }
                     }
                  ],
                  "isOptional":true
               }
            }
         },
         "outputDefinitions":{
            "parameters":{
               "Output":{
                  "parameterType":"NUMBER_INTEGER"
               },
               "gcp_resources":{
                  "parameterType":"STRING"
               }
            }
         },
         "executorLabel":"exec-sum-numbers"
      }
   },
   "root":{
      "dag":{
         "tasks":{
            "sum-numbers":{
               "taskInfo":{
                  "name":"sum-numbers"
               },
               "inputs":{
                  "parameters":{
                     "project":{
                        "runtimeValue":{
                           "constant":"my-project"
                        }
                     },
                     "b":{
                        "runtimeValue":{
                           "constant":2.0
                        }
                     },
                     "a":{
                        "runtimeValue":{
                           "constant":1.0
                        }
                     },
                     "location":{
                        "runtimeValue":{
                           "constant":"us-central1"
                        }
                     }
                  }
               },
               "cachingOptions":{
                  "enableCache":true
               },
               "componentRef":{
                  "name":"comp-sum-numbers"
               }
            }
         }
      }
   }
}